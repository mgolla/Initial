(function(n,t){typeof module!="undefined"&&module.exports?module.exports=t(require("angular")):typeof define=="function"&&define.amd?define(["angular"],t):t(n.angular)})(this,function(n){"use strict";var f=n.module("ngDialog",[]),t=n.element,i=n.isDefined,r=(document.body||document.documentElement).style,s=i(r.animation)||i(r.WebkitAnimation)||i(r.MozAnimation)||i(r.MsAnimation)||i(r.OAnimation),e="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",h="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",o=!1,u={};return f.provider("ngDialog",function(){var c=this.defaults={className:"ngdialog-theme-default",plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceBodyReload=function(n){o=n||!1};this.setDefaults=function(t){n.extend(c,t)};var l=0,i=0,r,f={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(a,v,y,p,w,b,k,d,g,nt){var it=a.find("body"),tt,rt;return o&&b.$on("$locationChangeSuccess",function(){it=a.find("body")}),tt={onDocumentKeydown:function(n){n.keyCode===27&&rt.close("$escape")},activate:function(n){var t=n.data("$ngDialogOptions");if(t.trapFocus){n.on("keydown",tt.onTrapFocusKeydown);it.on("keydown",tt.onTrapFocusKeydown)}},deactivate:function(n){n.off("keydown",tt.onTrapFocusKeydown);it.off("keydown",tt.onTrapFocusKeydown)},deactivateAll:function(){n.forEach(function(t){var i=n.element(t);tt.deactivate(i)})},setBodyPadding:function(n){var t=parseInt(it.css("padding-right")||0,10);it.css("padding-right",t+n+"px");it.data("ng-dialog-original-padding",t)},resetBodyPadding:function(){var n=it.data("ng-dialog-original-padding");n?it.css("padding-right",n+"px"):it.css("padding-right","")},performCloseDialog:function(n,t){var o=n.attr("id"),h=u[o],c,l;h&&(typeof d.Hammer!="undefined"?(c=h.hammerTime,c.off("tap",r),c.destroy&&c.destroy(),delete h.hammerTime):n.unbind("click"),i===1&&it.unbind("keydown"),n.hasClass("ngdialog-closing")||(i-=1),l=n.data("$ngDialogPreviousFocus"),l&&l.focus(),b.$broadcast("ngDialog.closing",n),i=i<0?0:i,s?(h.$destroy(),n.unbind(e).bind(e,function(){n.remove();i===0&&(it.removeClass("ngdialog-open"),tt.resetBodyPadding());b.$broadcast("ngDialog.closed",n)}).addClass("ngdialog-closing")):(h.$destroy(),n.remove(),i===0&&(it.removeClass("ngdialog-open"),tt.resetBodyPadding()),b.$broadcast("ngDialog.closed",n)),f[o]&&(f[o].resolve({id:o,value:t,$dialog:n,remainingDialogs:i}),delete f[o]),u[o]&&delete u[o])},closeDialog:function(t,i){var u=t.data("$ngDialogPreCloseCallback"),r;u&&n.isFunction(u)?(r=u.call(t,i),n.isObject(r)?r.closePromise?r.closePromise.then(function(){tt.performCloseDialog(t,i)}):r.then(function(){tt.performCloseDialog(t,i)},function(){return}):r!==!1&&tt.performCloseDialog(t,i)):tt.performCloseDialog(t,i)},onTrapFocusKeydown:function(t){var r=n.element(t.currentTarget),i,u,f;if(r.hasClass("ngdialog"))i=r;else if(i=tt.getActiveDialog(),i===null)return;u=t.keyCode===9;f=t.shiftKey===!0;u&&tt.handleTab(i,t,f)},handleTab:function(n,t,i){var r=tt.getFocusableElements(n);if(r.length===0){document.activeElement&&document.activeElement.blur();return}var o=document.activeElement,u=Array.prototype.indexOf.call(r,o),e=u===-1,s=u===0,h=u===r.length-1,f=!1;i?(e||s)&&(r[r.length-1].focus(),f=!0):(e||h)&&(r[0].focus(),f=!0);f&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(n){var e=n[0],i=e.querySelector("*[autofocus]"),r,u,f;if(i===null||(i.focus(),document.activeElement!==i)){if(r=tt.getFocusableElements(n),r.length>0){r[0].focus();return}u=tt.filterVisibleElements(e.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));u.length>0&&(f=u[0],t(f).attr("tabindex","-1").css("outline","0"),f.focus())}},getFocusableElements:function(n){var t=n[0],i=t.querySelectorAll(h);return tt.filterVisibleElements(i)},filterVisibleElements:function(n){for(var t,r=[],i=0;i<n.length;i++)t=n[i],(t.offsetWidth>0||t.offsetHeight>0)&&r.push(t);return r},getActiveDialog:function(){var n=document.querySelectorAll(".ngdialog");return n.length===0?null:t(n[n.length-1])},applyAriaAttributes:function(n,t){if(t.ariaAuto){if(!t.ariaRole){var i=tt.getFocusableElements(n).length>0?"dialog":"alertdialog";t.ariaRole=i}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6");t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&n.attr("role",t.ariaRole);tt.applyAriaAttribute(n,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector);tt.applyAriaAttribute(n,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(n,i,r,u){var o,e,f;return r&&n.attr(i,r),u?(o=n.attr("id"),e=n[0].querySelector(u),!e)?void 0:(f=o+"-"+i,t(e).attr("id",f),n.attr(i,f),f):void 0}},rt={open:function(e){function st(n,t){return w.get(n,t||{}).then(function(n){return n.data||""})}function ht(t){return t?n.isString(t)&&o.plain?t:typeof o.cache=="boolean"&&!o.cache?st(t,{cache:!1}):v.get(t)||st(t,{cache:!0}):"Empty template"}var ct=this,o=n.copy(c),et=++l,ut="ngdialog"+et,ot,h,s,ft,a;return e=e||{},n.extend(o,e),f[ut]=ot=p.defer(),u[ut]=h=n.isObject(o.scope)?o.scope.$new():b.$new(),a=n.extend({},o.resolve),n.forEach(a,function(t,i){a[i]=n.isString(t)?nt.get(t):nt.invoke(t,null,null,i)}),p.all({template:ht(o.template||o.templateUrl),locals:p.all(a)}).then(function(u){var e=u.template,w=u.locals,c,l,a,f,p;if(v.put(o.template||o.templateUrl,e),o.showClose&&(e+='<div class="ngdialog-close"><\/div>'),s=t('<div id="ngdialog'+et+'" class="ngdialog"><\/div>'),s.html(o.overlay?'<div class="ngdialog-overlay"><\/div><div class="ngdialog-content" role="document">'+e+"<\/div>":'<div class="ngdialog-content" role="document">'+e+"<\/div>"),s.data("$ngDialogOptions",o),o.data&&n.isString(o.data)?(c=o.data.replace(/^\s*/,"")[0],h.ngDialogData=c==="{"||c==="["?n.fromJson(o.data):o.data):o.data&&n.isObject(o.data)&&(h.ngDialogData=o.data),o.controller&&(n.isString(o.controller)||n.isArray(o.controller)||n.isFunction(o.controller))&&(l=o.controller,o.controllerAs&&n.isString(o.controllerAs)&&(l+=" as "+o.controllerAs),a=g(o.controller,n.extend(w,{$scope:h,$element:s})),s.data("$ngDialogControllerController",a)),o.className&&s.addClass(o.className),ft=o.appendTo&&n.isString(o.appendTo)?n.element(document.querySelector(o.appendTo)):it,tt.applyAriaAttributes(s,o),o.preCloseCallback&&(n.isFunction(o.preCloseCallback)?f=o.preCloseCallback:n.isString(o.preCloseCallback)&&h&&(n.isFunction(h[o.preCloseCallback])?f=h[o.preCloseCallback]:h.$parent&&n.isFunction(h.$parent[o.preCloseCallback])?f=h.$parent[o.preCloseCallback]:b&&n.isFunction(b[o.preCloseCallback])&&(f=b[o.preCloseCallback])),f&&s.data("$ngDialogPreCloseCallback",f)),h.closeThisDialog=function(n){tt.closeDialog(s,n)},k(function(){var i=document.querySelectorAll(".ngdialog"),t,n;tt.deactivateAll(i);y(s)(h);t=d.innerWidth-it.prop("clientWidth");it.addClass("ngdialog-open");n=t-(d.innerWidth-it.prop("clientWidth"));n>0&&tt.setBodyPadding(n);ft.append(s);tt.activate(s);o.trapFocus&&tt.autoFocus(s);o.name?b.$broadcast("ngDialog.opened",{dialog:s,name:o.name}):b.$broadcast("ngDialog.opened",s)}),o.closeByEscape&&it.bind("keydown",tt.onDocumentKeydown),o.closeByNavigation&&b.$on("$locationChangeSuccess",function(){tt.closeDialog(s)}),o.preserveFocus&&s.data("$ngDialogPreviousFocus",document.activeElement),r=function(n){var r=o.closeByDocument?t(n.target).hasClass("ngdialog-overlay"):!1,i=t(n.target).hasClass("ngdialog-close");(r||i)&&rt.close(s.attr("id"),i?"$closeButton":"$document")},typeof d.Hammer!="undefined"){p=h.hammerTime=d.Hammer(s[0]);p.on("tap",r)}else s.bind("click",r);return i+=1,rt}),{id:ut,closePromise:ot.promise,close:function(n){tt.closeDialog(s,n)}}},openConfirm:function(i){var u=p.defer(),r={closeByEscape:!1,closeByDocument:!1},f;return n.extend(r,i),r.scope=n.isObject(r.scope)?r.scope.$new():b.$new(),r.scope.confirm=function(n){u.resolve(n);var i=t(document.getElementById(f.id));tt.performCloseDialog(i,n)},f=rt.open(r),f.closePromise.then(function(n){return n?u.reject(n.value):u.reject()}),u.promise},isOpen:function(n){var i=t(document.getElementById(n));return i.length>0},close:function(n,i){var r=t(document.getElementById(n));return r.length?tt.closeDialog(r,i):rt.closeAll(i),rt},closeAll:function(n){for(var u,r=document.querySelectorAll(".ngdialog"),i=r.length-1;i>=0;i--)u=r[i],tt.closeDialog(t(u),n)},getDefaults:function(){return c}},rt}]}),f.directive("ngDialog",["ngDialog",function(t){return{restrict:"A",scope:{ngDialogScope:"="},link:function(i,r,u){r.on("click",function(r){var e,f;r.preventDefault();e=n.isDefined(i.ngDialogScope)?i.ngDialogScope:"noScope";n.isDefined(u.ngDialogClosePrevious)&&t.close(u.ngDialogClosePrevious);f=t.getDefaults();t.open({template:u.ngDialog,className:u.ngDialogClass||f.className,controller:u.ngDialogController,controllerAs:u.ngDialogControllerAs,scope:e,data:u.ngDialogData,showClose:u.ngDialogShowClose==="false"?!1:u.ngDialogShowClose==="true"?!0:f.showClose,closeByDocument:u.ngDialogCloseByDocument==="false"?!1:u.ngDialogCloseByDocument==="true"?!0:f.closeByDocument,closeByEscape:u.ngDialogCloseByEscape==="false"?!1:u.ngDialogCloseByEscape==="true"?!0:f.closeByEscape,preCloseCallback:u.ngDialogPreCloseCallback||f.preCloseCallback})})}}}]),f});
//# sourceMappingURL=ngDialog.min.js.map
